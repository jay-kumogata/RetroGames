# 01_ゲーム製作: 04_ビデオゲーム復刻記

## はじめに

ビデオゲームを復刻した記録です．
元々のタイトルは，「ビデオゲーム復刻論」でしたが，「復刻論」を論じるつもりも，能力もありません．

## Chip8からPyxelへの翻訳系の検討

### 2021-11-09

当初はゲーム製作という課題でしたが，古いゲームを復刻するという課題に移行していくことになりました．

_(2025-05-02) ゲーム研究は，製作/歴史/収集というテーマを掲げて，開始されたのです．が，実態は，製作より復刻が中心になりつつあります．_

### 2022-02-18

Octo/Chip8から，Pyxelへの翻訳系を書く夢を見ました．
その翻訳系でPyxelコードを生成して，キャラクタを高精細化して，着色していくと，古いゲームがPyxelでも復刻できるかもしれません．
これが本当のピクセルリマスタかもしれません．

_(2025-05-02) Pyxelを使い始めて，すぐにOcto/Chip8からの移植を検討していました．_

### 2023-01-06

まず，Chip8の最も簡単なプログラム[Tank](https://johnearnest.github.io/Octo/index.html?key=30fe5_xD)をPyxelに移植してみました．
意味論的なことを考えつつ，移植していきます．
Pyxelはゲームエンジン的な書き方があるので，意味論を考えないと移植は難しかったです．

![](https://github.com/jay-kumogata/PyxelChip8/blob/main/pyxel/tank/screenshots/tank01.gif)

_(2025-05-10) 当時の[コード](https://github.com/jay-kumogata/PyxelChip8/blob/main/pyxel/tank/)
をGithubの方に上げました．ドット絵は，本日着色しました．_

静的な翻訳系を書けるかなと考えていたが，難しいことが分かりました．
動的な翻訳系を書けば，書けないことはない気がします．
マッピングするのが，x86ではなく，PythonのVM命令という可能性を考えられます．
以前，Rubyでも，同様のことができるというコメントは，頂戴したことがあります．

_(2025-05-02) 静的な翻訳系とは，実行前にプログラムの全体を翻訳する系を，
動的な翻訳系とは，実行中にプログラムの一部を逐次的に翻訳する系を，
それぞれ意味すると想像します．_

最終的な目標は，新しいプラットフォームに移行しても，毎回同じコードを書かなくてもすむことなので，結構それは難しいのだなという印象を持ちました．
今回みたいに，淡々と移植作業をしてしまうと，比較的簡単に移植はできます．
現場では，そうやって移植が行われるのかもしれないです．

### 2023-04-06

今週前半は，プログラム変換について考えていました．
ある程度のレベルであれば，完成できる気がしてきましたが，逆に，作る意味があるかなというが悩みです．

	アルゴリズム
	
	1) Chip8プログラム(.ch8)をパース，以下をラベル化：
	　jump命令の参照先
	　call命令の参照先
	　sprite命令の参照先

	2) コード生成

	jump命令の参照先毎に繰り返し：
	　関数定義開始コードを生成：
	　アドレス毎に繰り返し：
	　　if (アドレスがラベルとして登録されているか）：
	　　　yes：ループ終了
	　　　no：対応するコード生成：
	　　関数定義終了コードを生成
	
	call命令の参照先も同じ：
	
	sprite命令の参照先：
	　アドレスとバイト長から，キャラクタ配列を用意

### 2023-04-07

静的解析で逆コンパイルした結果を使って，Pyxel化を試みました．
途中までしかできていませんが，大体動かせそうなところまでできたので，一旦おしまいです．
プログラムカウンタやスタックポインタは，使わないので，Pythonの機構で代用できることがわかりました．
いよいよ，Chip8をPyxelに変換して，何がよいのかわからなくなりつつあります．
週末に考えてみます．

### 2023-10-20

この課題は，今年中の宿題です．
ピンボールの方は，本日完成したのですが，こちらはさらに難しいです．
技術的に不可能ではないのかもしれないのですが，可読性の低いコードが出力されますので，
結局リファクタリングすることになる気がします．

模擬器やFPGA以外に，ビデオゲームの復刻技術として，プログラム変換もあるかと考えていたのです．
が，バイナリからソースリストに変換するのは，難しそうです．
ただ，仕様書レベルで，人間が移植するというのであれば，難易度は高くないのでしょう．
しかも，一般的です．

### 2023-10-27

#### プログラム変換研究

2023年のビデオゲーム研究のテーマです．
先週にピンボールの方は，なんとか完成(適当実装)したので，もう1つのテーマを考えることにします．
残り3ヶ月では，どうにもならないと思いますけど，今までの検討をまとめる意味で書いてみます．

#### ここまでの検討

① ターゲット選定

まず最も簡単なターゲットとして，CHIP8のtankプログラムを選定しました．

② 手動変換(意味論的)

意味論的なレベルでの手動変換を試行しました．結局普通の移植と同じです．
自動変換ツールで，このレベルを実現するのは，難しいと思われます．

③ 手動変換(統語論的)

統語論的なレベルでの手動変換も試行しました．
プログラム変換を意識して，コーディングしたので，結構冗長な記述になりました．
アルゴリズムを検討して，書き出したので，実装はできるはずです．
ただ，それを実装して，どうするかというのが悩みどころでしょうか．

_(2025-04-29) Chip8からPyxelへの翻訳系を書く試みをしていたのですが，
生成されるコードがかなりプリミティブであることがわかったので，この時点で一旦やる気を失いました．
そして，手動での変換を指向するようになります．
Chip8と同時にBASIC言語のソースを復刻することも試行していました．_
 
## BasicからPyxelへの移植

### 2023-09-11

昔ベーマガに載ったゲームがありましたが，持っていない機種のゲームだったので，遊ぶことができませんでした．
どんなゲームだろうと思っていたので，40年の時を超えて，Pyxelで作り直しています．
異常に難しいゲームでした．
ある程度まとまった時点で，リリースしようかと考えています．

### 2023-09-12

当時のBASICで書かれたゲームは，なんか偶然で動いてるというか，設計しないで思いつきで作っているようです．
なので，Pyxel化しつつ，リファクタリングしないと意味不明なコードになります．
ただ，ビデオゲームを買っても，遊ぶわけでもないですし，まして，自分で作ったゲームなど，遊ぶわけないですね．
できたら，おしまいです．

### 2023-09-15

BASICマガジン1983年10月号に掲載の「ASLM」というゲームをPyxel化しました．
本日は大雨でした．

### 2023-09-18

ウィングマン氏の [ACLM](https://archive.org/details/micom-basic-magazine-issue-16-october-1983/page/n92/mode/1up) をPyxelに移植しました．
オリジナルは，「マイコン BASIC Magazine（1983年10月号）」に掲載されています．
自機（赤）を操作して，敵機（青）を上下左右にぶつけて倒すゲームです．
異常に難しいので，自機と敵機が衝突した場合は，「負け」ではなく，「引分け」にルール変更しました．
また，オリジナルには，その後に，都市を攻撃するシーン（2面）があるようです．

![](https://github.com/jay-kumogata/RetroGames/blob/main/pyxel/aclm/screenshots/aclm01.gif)
![](https://github.com/jay-kumogata/RetroGames/blob/main/pyxel/aclm/screenshots/aclm02.gif)
![](https://github.com/jay-kumogata/RetroGames/blob/main/pyxel/aclm/screenshots/aclm03.gif)

### 2024-06-14

[オートレース(1画面ソフト)](https://github.com/jay-kumogata/RetroGames/tree/main/pyxel/autorace)を公開しました．
昔懐かしい[はるみのゲームライブラリ](https://archive.org/details/Fm-7Fm-8/page/n173/mode/2up)からの移植です．
PyxelRogueを開発(移植)する過程で蓄積された「キャラクタ画面の扱い方のノウハウ」を再利用してみました．

![](https://github.com/jay-kumogata/RetroGames/blob/main/pyxel/autorace/screenshots/autorace01.gif)

## 生成AIによるChip8からPyxelへの移植

_(2025-07-11) [こちら](https://github.com/jay-kumogata/PyxelChip8/blob/main/pyxel/doc/220424_PyxelNote.md)
に，移動しました．_

## まとめ

### 2025-04-28

ビデオゲームの復刻については，
1996年頃に住んでいた駅前のレンタルビデオ店で，映画「ローマの休日」を借りたところから話がはじまります．
そのレンタルビデオ店に，映画「ローマの休日」を返却する時に，「昔の映画は簡単に観れるのに，昔のビデオゲームは簡単には遊べないのは，なぜだろう．」という疑問を持ったのです．
その疑問を解決する技術として，模擬器(Emulator)があることを知り，1998年頃の模擬器開発につながっていくわけです．

_(2025-04-29) 模擬器の開発経緯については，それぞれのリポジトリの開発記を参照ください．_

しかし，そこから20年位は，色々と忙しくてできなかったのですが，2020年頃のコロナ禍の時に，再度ビデオゲームの復刻に手を出すことになります．
Chip8向けのOcto開発環境に出会い，そこで昔のアセンブリ言語のソースやバイナリを，Octo記法で復刻することから始めてみました．

_(2025-04-29) その経緯は，PyxelChip8のリポジトリを参照ください．_

さらに，2022年頃に，PyxelというPythonベースのゲームエンジンを使うようになりました．
Octo記法で復刻したアセンブリ言語のソースを，Pyxelに移植できたら，キャラクタを豪華にしたりして，面白いゲームになるかもしれない，とか考えるようになりました．
最初は，Chip8バイナリを，Pythonコードに変換する翻訳系を書こうと考えました．
やればできることは分かったのですが，生成されるPythonコードが，かなりプリミティブになるので，開発を逡巡しました．
毎朝，川沿いの歩道を散歩しているのですが，そこで何度も実装について考えていました．
ただ，結局は作りませんでした．

その流れがあり，いくつかのビデオゲームは手動で復刻してみました．
昔のBASICで書かれたコードも，Pyxelに移してみました．

そんなこんなで時間が経ったのですが，2025年3月に，X(旧Twitter)で「ELITEデモ(アセンブリ言語ソース3.8KL)を生成AI(Grok3等)で，
JavaScriptに変換した．」というポストを発見します．
試しに，最も規模が小さいBreakoutを生成AIでPyxelに変換してみると，普通に動いてしまったのです．

### 2025-05-01

X(Twitter)にも投稿しました．
Chip8からPyxelへの変換で，ゲーム復刻というアイディアを考えてきました．
最初は，純粋な翻訳系を書こうと考えていたのですが，出力結果がプリミティブ（アセンブラっぽいPython）になっちゃうことが分かった時点でやめてしまいました．
意味論的なことも考えて，移植をしないと，プログラムとしての保守性も悪いし，模擬器で動かすのと大差ないことになってしまいます．

それで，しばらく人間が移植してたのですが，色々忙しく，生産性も低いので，遅々として進まないことが課題でした．
そこに生成AIが出てきて，結構意味も考えて移植してくれることが分かり，生産性も向上しました．
純粋な翻訳系は，統語論的な処理はできますが，意味論には踏み込みません．
一方で，人間や生成AIは，意味論的な移植をこなせます．
生成AIは，人間の模擬器だとして，翻訳系と生成AIを分かつものは何なんでしょうか．
おそらく生成AIの発展は層を深くできたことにあるのでしょうから，意味論的な層が存在するか否かが違うということなんでしょう．
人間も意味を考えることができますが，それらもニューロンによる意味論的な層で果たしているのでしょうか．
一応そう考えておくことにします．

また，蛇足ではあるのですが，産業的には，CobolからJavaへの変換は重要です．
最近は，生成AIを使っているみたいなのですが，CobolからJavaへ直接変換すると，CobolっぽいJava(=Jabol)になってしまうそうです．
そこで，Cobolから仕様，仕様からJavaに変換するといい感じになるらしいです．
一度仕様にすることで，意味が蒸留されるのでしょう．

_(2025-05-04) ビデオゲームの復刻については，一旦完了で，新しいテーマに移ることにします．_

以上
